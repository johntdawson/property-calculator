<!DOCTYPE html>
<html>

<head>
  <title>Property Calculator</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/themes/default/jquery.mobile-1.4.3.min.css">
	<link rel="shortcut icon" href="favicon.ico">
  <style>
    #footer { text-align: center; }
    .ui-controlgroup-controls { padding: 0 9px; }
    .ui-header .ui-title { margin: 0 10%; padding-top: 20px;}
    .ui-footer .ui-title { margin: 0; }
    .collapsible { padding:0 8px; }
    .value { position:absolute; right:40px;top:13px; }
    .money:before { content:"$" }
    .percent:after { content:"%" }
    .ui-icon-calculator:after { background-image: url("img/calculator-white.svg"); }
    .ui-icon-logo:after { background-image: url("img/logo-white.svg"); }
    .ui-header-fixed, .ui-footer-fixed { background-color: #2ad; border-color: #2ad; color: #fff; text-shadow: 0 1px 0 #08b; }
    #summary h2 a { background-color: #29e3b4; border-color: #29e3b4; color: #fff; text-shadow: 0 1px 0 #08b; }
    .ui-li-divider { background-color: #ccc; border-color: #eaeaea; color: #666; text-shadow: none; font-weight: normal; }
    .sm-amount { font-size: 11px; padding-left:5px; }
    .ui-header-fixed .ui-btn { top: 18px; }
    .ui-page { -webkit-backface-visibility: hidden; }
  </style>
	<script src="js/jquery.js"></script>
	<script src="js/jquery.mobile-1.4.3.min.js"></script>
	<script src="js/jquery.mask.js"></script>
	<script src="js/jquery.maskMoney.min.js"></script>
	<script src="js/fastclick.js"></script>
  <script>
    $(document).on( "pagecreate", function() {

      // Fix for 300ms click delay
      FastClick.attach(document.body);

      // Default settings
      defaultData = {
        propertyName : "New Property",
        estimatedPropertyValue : "0",
        purchasePrice : "0",
        rentalIncome : "0",
        propertyTaxes : "0",
        homeownersInsurance : "0",
        homeownersAssociation : "0",
        otherExpenses : "0",
        downPaymentPercent : "20",
        mortgageInterestRate : "5.0",
        mortgageLoanTerm : "30",
        closingCostsPercent : "5",
        propertyManagementPercent : "10",
        maintenanceReservePercent : "5",
        vacancyAllowancePercent : "7",
        appreciationRate : "3",
        otherExpensesDescription : ""
      }

      // Pageinit: List
      $( document ).delegate("#list", "pageinit", function() {

        // New button
        $('#new').on('click', function() {
          var dataToStore = JSON.stringify(defaultData);
          var id = 'property-' + Date.now(); 
          localStorage.setItem( id, dataToStore );
          $('#list ul li[class="ui-first-child"]').removeAttr('class');
          $('#list ul').prepend( $('<li class="ui-li-has-alt" id="'+id+'"><a class="ui-first-child ui-btn ui-btn-icon-right ui-icon-carat-r" href="#main" data-transition="slidefade">'+defaultData.propertyName+'</a><a class="delete ui-btn ui-btn-icon-notext ui-icon-delete" href="#" title="Delete"></a></li>').hide().fadeIn(400) );
        });

      });

      // Pagebeforeshow: List
      $( document ).delegate("#list", "pagebeforeshow", function() {

        // Load local data, if exists        
        if (localStorage != null) {
          // Load data
          var properties = localStorage;
          $('#properties').html('');
          $.each(properties, function( id, data ) {
            var property = JSON.parse(data);
            $('#properties').append('<li class="ui-li-has-alt" id="'+id+'"><a class="ui-btn ui-btn-icon-right ui-icon-carat-r" href="#main" data-transition="slidefade">'+property.propertyName+'</a><a class="delete ui-btn ui-btn-icon-notext ui-icon-delete" href="#" title="Delete"></a></li>');
          });
          // Sort properties by id (most recent first)
          $("#properties").html(
              $("#properties").children("li").sort(function (b, a) {
                  return $(a).attr("id").toUpperCase().localeCompare(
                      $(b).attr("id").toUpperCase());
              }) // End Sort
          ); // End HTML
          // Update styling
          $('#list ul li').first().addClass( "ui-first-child" );
          $('#list ul li').last().addClass( "ui-last-child" );
        } else {
          console.log("no data");
        }

      });

      // Pageinit: Main
      $( document ).delegate("#main", "pageinit", function() {

        // Create page for each list item
        $('.page li a').on('click', function() {
          $('.ui-dialog-temp').remove(); //garbage collection
          href = $(this).attr('href').replace("#" , "");
          createPage(page[href]);
        });

        // Email property
        $('#mail').on('click', function() {
          var subject = encodeURI("Property Details: " + propertyName);
          var body = encodeURI(
            "Purchase Price: " + purchasePrice + "\n" +
            "Rental Income: " + rentalIncome + "\n" +
            "Operating Expenses: " + operatingExpenses + "\n" +
            "Monthly Cash Flow: " + monthlyCashFlow + "\n"
          );
          var href = "mailto:?subject="+subject+"&body="+body;
          $(this).attr('href',href)
        });

      });

      // Page Init: Main
      $( document ).delegate("#main", "pagebeforeshow", function() {
        data = JSON.parse(localStorage.getItem(id));
        init(data);
      });

      // Property button
      $( document ).on( "click", '#properties li', function(e) {
        id = $(this).attr('id');
        //console.log(id);
      });

      // Delete button
      $( document ).on( "click", '#properties li a.delete', function(e) {
        id = $(this).parent().attr('id');
        localStorage.removeItem(id);
        $(this).parent().remove();
      });


      // Camera button
      $( document ).on( "click", '#camera', function(e) {
        navigator.camera.getPicture(onSuccess, onFail, { quality: 50,
            destinationType: Camera.DestinationType.DATA_URL
        });
        
        function onSuccess(imageData) {
            var image = document.getElementById('myImage');
            image.src = "data:image/jpeg;base64," + imageData;
        }
        
        function onFail(message) {
            alert('Failed because: ' + message);
        }
      });

      // Remember scroll position
      $( document ).delegate("#main", "pagebeforeshow", function() {
        $('li').on('click', function(){
          scrollPosition = $(document).scrollTop();
        });
      });
      $( document ).delegate("#main", "pageshow", function() {
        if(scrollPosition !== null) {
          $.mobile.silentScroll(scrollPosition);
        }
      });
      var scrollPosition = null;

      // Create pages
      createPage = function( page ) {

        // Create pages with input fields
        if (page.type=='input') {
          $('body').append(
            '<div data-role="page" id="' + page.id + '" class="ui-dialog-temp" data-theme="a">' +
            '	<div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">' +
            '   <a class="ui-btn ui-btn-icon-left ui-icon-carat-l ui-btn-icon-notext ui-corner-all" href="#'+page.back+'" data-transition="slidefade" data-direction="reverse">Back</a>' +
            '		<h1>' + page.title + '</h1>' +
            '   <a id="save" class="ui-btn ui-btn-right ui-icon-check ui-btn-icon-notext ui-corner-all" href="#'+page.back+'" data-transition="slidefade" data-direction="reverse">Save</a>' +
            '	</div>' +
            '	<div role="main" class="ui-content">' +
            '   <input class="inputvalue '+page.mask+'" name="number" id="number-pattern" value="'+page.value+'" type="text" data-clear-btn="true" data-precision="0" data-allowZero="true">' +
            page.content +
            '	</div>' +
            '</div>'
          );

          // Input mask
          $('input.currency').maskMoney(); //https://github.com/plentz/jquery-maskmoney
          $('input.percent').mask('0Z.0ZZ', {translation:  {'Z': {pattern: /[0-9]/, optional: true}}}); //http://igorescobar.github.io/jQuery-Mask-Plugin
          $('input.years').mask('00', {reverse: true}); //http://igorescobar.github.io/jQuery-Mask-Plugin

          // Bind enter key to specific button on page if input focused
          $(document).keypress(function(e){
            if (e.which == 13 && $(".inputvalue").is(":focus") ){
              $("#save").click();
            }
          });

        }

        // Create pages with info dialogs
        if (page.type=='info') {
          $('body').append(
            '<div data-role="page" id="' + page.id + '" class="ui-dialog-temp" data-theme="a">' +
            '	<div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">' +
            '		<h1>' + page.title + '</h1>' +
            '	</div>' +
            '	<div role="main" class="ui-content">' +
            page.content +
            '	</div>' +
            '</div>'
          );
        }

      }

      // Submit input values
      $('body').on( "click", "#save", function(e) {
        var key = $(this).parent().parent().attr('id');
        var value = $('#'+key+' .inputvalue').val();
        $("a[href='#"+key+"'] span.value").html(value);
        calculate();
        saveData();
      });

      // Calculate Values
      function calculate() {
        propertyName = $("a[href='#propertyName'] span.value").html();
        estimatedPropertyValue = clean( $("a[href='#estimatedPropertyValue'] span.value").html() );
        purchasePrice = clean( $("a[href='#purchasePrice'] span.value").html() );
        downPaymentPercent = clean( $("a[href='#downPaymentPercent'] span.value").html() );
        closingCostsPercent = clean( $("a[href='#closingCostsPercent'] span.value").html() );
        downPayment = purchasePrice * downPaymentPercent / 100;
        equityAtPurchase = Number(estimatedPropertyValue - purchasePrice + downPayment);
        loanAmount = purchasePrice - downPayment;
        closingCosts = loanAmount * closingCostsPercent / 100;
        cashAtClosing = downPayment + closingCosts;
        mortgageInterestRate = clean( $("a[href='#mortgageInterestRate'] span.value").html() );
        mortgageLoanTerm = clean( $("a[href='#mortgageLoanTerm'] span.value").html() );
        mortgagePayment = Math.round ( -1 * PMT( ( mortgageInterestRate / 100 / 12 ), mortgageLoanTerm * 12, loanAmount) );
        mortgagePaymentYearly = mortgagePayment * 12;
        rentalIncome = clean( $("a[href='#rentalIncome'] span.value").html() );
        propertyTaxes = clean( $("a[href='#propertyTaxes'] span.value").html() );
        homeownersInsurance = clean( $("a[href='#homeownersInsurance'] span.value").html() );
        homeownersAssociation = clean( $("a[href='#homeownersAssociation'] span.value").html() );
        propertyManagementPercent = clean( $("a[href='#propertyManagementPercent'] span.value").html() );
        maintenanceReservePercent = clean( $("a[href='#maintenanceReservePercent'] span.value").html() );        
        vacancyAllowancePercent = clean( $("a[href='#vacancyAllowancePercent'] span.value").html() );
        propertyManagement = Math.round( propertyManagementPercent / 100 * rentalIncome );
        maintenanceReserve = Math.round( maintenanceReservePercent / 100 * rentalIncome );
        vacancyAllowance = Math.round( vacancyAllowancePercent / 100 * rentalIncome );
        otherExpenses = clean( $("a[href='#otherExpenses'] span.value").html() );
        otherExpensesDescription = $("a[href='#otherExpensesDescription'] span.value").html();
        operatingExpenses = propertyTaxes + homeownersInsurance + homeownersAssociation + propertyManagement + maintenanceReserve + vacancyAllowance + otherExpenses;
        monthlyCashFlow = rentalIncome - operatingExpenses - mortgagePayment;
        appreciationRate = clean( $("a[href='#appreciationRate'] span.value").html() );        
        appreciationYear1 = Math.round( estimatedPropertyValue * appreciationRate / 100 );
        principleYear1 = Math.round( BalancePaid( mortgagePayment, ( mortgageInterestRate / 100 ), loanAmount, 12 ) );
        cashOnCashReturn = ( ( ( monthlyCashFlow * 12 ) + appreciationYear1 + principleYear1 ) / cashAtClosing ) * 100;
        capRate = ( ( ( rentalIncome - operatingExpenses ) * 12 ) / purchasePrice ) * 100;
        propertyValueYear5 = Compound( estimatedPropertyValue, ( appreciationRate / 100 ), 4 );
        equityInFiveYears = Math.round( propertyValueYear5 - ( loanAmount - BalancePaid( mortgagePayment, ( mortgageInterestRate / 100 ), loanAmount, 60 ) ) );
        // Update view
        getPageData();
        update();
      }

      // Update Values
      function update() {
        $("#main h1").html(propertyName);
        $("a[href='#estimatedPropertyValue'] span.value").html(formatMoney(estimatedPropertyValue));
        $("a[href='#purchasePrice'] span.value").html(formatMoney(purchasePrice));
        $("a[href='#equityAtPurchase'] span.value").html(formatMoney(equityAtPurchase));
        $("a[href='#loanAmount'] span.value").html(formatMoney(loanAmount));
        $("a[href='#downPayment'] span.value").html(formatMoney(downPayment));
        $("a[href='#closingCosts'] span.value").html(formatMoney(closingCosts));
        $("a[href='#cashAtClosing'] span.value").html(formatMoney(cashAtClosing));
        $("a[href='#mortgagePayment'] span.value").html(formatMoney(mortgagePayment));
        $("a[href='#mortgagePaymentYearly'] span.value").html(formatMoney(mortgagePaymentYearly));
        $("a[href='#rentalIncome'] span.value").html(formatMoney(rentalIncome));
        $("a[href='#propertyTaxes'] span.value").html(formatMoney(propertyTaxes));
        $("a[href='#homeownersInsurance'] span.value").html(formatMoney(homeownersInsurance));
        $("a[href='#homeownersAssociation'] span.value").html(formatMoney(homeownersAssociation));
        $("a[href='#propertyManagement'] span.value").html(formatMoney(propertyManagement));
        $("a[href='#maintenanceReserve'] span.value").html(formatMoney(maintenanceReserve));
        $("a[href='#vacancyAllowance'] span.value").html(formatMoney(vacancyAllowance));
        $("a[href='#otherExpenses'] span.value").html(formatMoney(otherExpenses));
        $("a[href='#monthlyCashFlow'] span.value").html(formatMoney(monthlyCashFlow));
        $("a[href='#capRate'] span.value").html(capRate.toFixed(2));
        $("a[href='#cashOnCashReturn'] span.value").html(cashOnCashReturn.toFixed(2));
        $("a[href='#equityInFiveYears'] span.value").html(formatMoney(equityInFiveYears));
        $("a[href='#downPayment'] span.sm-amount").html('('+downPaymentPercent+'%)');
        $("a[href='#closingCosts'] span.sm-amount").html('('+closingCostsPercent+'%)');
        $("a[href='#propertyManagement'] span.sm-amount").html('('+propertyManagementPercent+'%)');
        $("a[href='#maintenanceReserve'] span.sm-amount").html('('+maintenanceReservePercent+'%)');
        $("a[href='#vacancyAllowance'] span.sm-amount").html('('+vacancyAllowancePercent+'%)');
        if ( otherExpensesDescription != '' ) { $("a[href='#otherExpenses'] span.sm-amount").html('('+otherExpensesDescription+')') };
        if ( isFinite(capRate)===false ) { $("a[href='#capRate'] span.value").html('0.00') };
        if ( isFinite(cashOnCashReturn)===false ) { $("a[href='#cashOnCashReturn'] span.value").html('0.00') };
      }

      // Clean number
      function clean( str ) {
        str = str.replace(/,/g, ""); //remove all commas
        str = str.replace(/%/g, ""); //remove all %
        str = Number(str);
        return str;
      }
      
      // Mortgage PMT formula
      function PMT(i, n, p) {
        return i * p * Math.pow((1 + i), n) / (1 - Math.pow((1 + i), n));
      }

      // Balance Paid formula
      function BalancePaid( MonthlyPayment, Rate, Principle, months ) {
          return ((12 * MonthlyPayment) / Rate - Principle) * (Math.pow((1 + Rate / 12), months) - 1)
      }

      // Compounded Interest formula 
      function Compound(Orig, rate, yrs) {   
        return Orig * Math.pow((1.00 + rate), yrs);
      }

      // Format money
      function formatMoney(number, places, symbol, thousand, decimal) {
        number = number || 0;
        places = !isNaN(places = Math.abs(places)) ? places : 0;
        //symbol = symbol !== undefined ? symbol : "$";
        symbol = symbol !== undefined ? symbol : "";
        thousand = thousand || ",";
        decimal = decimal || ".";
        var negative = number < 0 ? "-" : "",
            i = parseInt(number = Math.abs(+number || 0).toFixed(places), 10) + "",
            j = (j = i.length) > 3 ? j % 3 : 0;
        return symbol + negative + (j ? i.substr(0, j) + thousand : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousand) + (places ? decimal + Math.abs(number - i).toFixed(places).slice(2) : "");
      }

      function saveData() {
        data = {
          propertyName : propertyName,
          estimatedPropertyValue : estimatedPropertyValue,
          purchasePrice : purchasePrice,
          rentalIncome : rentalIncome,
          propertyTaxes : propertyTaxes,
          homeownersInsurance : homeownersInsurance,
          homeownersAssociation : homeownersAssociation,
          otherExpenses : otherExpenses,
          downPaymentPercent : downPaymentPercent,
          mortgageInterestRate : mortgageInterestRate,
          mortgageLoanTerm : mortgageLoanTerm,
          closingCostsPercent : closingCostsPercent,
          propertyManagementPercent : propertyManagementPercent,
          maintenanceReservePercent : maintenanceReservePercent,
          vacancyAllowancePercent : vacancyAllowancePercent,
          appreciationRate : appreciationRate,
          otherExpensesDescription : otherExpensesDescription
        }
        var dataToStore = JSON.stringify(data);
        localStorage.setItem(id, dataToStore);
        //console.log(dataToStore); //debug
      } 

      // Initialize data
      function init(data) {
        $.each(data, function(key, value) {
          $("a[href='#"+key+"'] span.value").html(value);
        });
        calculate();
        saveData();
      }

      // Page data
      function getPageData() {
        page = {
          propertyName : {
            id : "propertyName",
            title : "Property Name",
            type : "input",
            back : "main",
            value: propertyName,
            content : "<p>Enter a property name.</p>"
          },
          estimatedPropertyValue : {
            id : "estimatedPropertyValue",
            title : "Estimated Property Value",
            type : "input",
            mask : "currency",
            back : "main",
            value: estimatedPropertyValue,
            content : "<p>The estimated property value can be determined from comparable property sales, Multiple Listing Service (MLS) data, appraisal reports, public records, etc. This figure is used as a baseline amount to estimate equity yet is not used to estimate cash flow.</p>"
          },
          purchasePrice : {
            id : "purchasePrice",
            title : "Purchase Price",
            type : "input",
            mask : "currency",
            back : "main",
            value: purchasePrice,
            content : "<p>The purchase price is the listed price, seller's price, or the anticipated cost of purchasing the property.</p>"
          },
          downPayment : {
            id : "downPayment",
            title : "Down Payment",
            type : "info",
            back : "main",
            content : "<p>The down payment is a type of payment made in cash during the onset of the purchase of a property. The payment typically represents only a percentage of the full purchase price; in some cases it is not refundable if the deal falls through. Financing arrangements are made by the purchaser to cover the remaining amount owed to the seller.</p><p><em>Down Payment ($"+downPayment+") = Purchase Price ($"+purchasePrice+") x Down Payment Percent ("+downPaymentPercent+"%)</em></p>"
          },
          equityAtPurchase : {
            id : "equityAtPurchase",
            title : "Equity at Purchase",
            type : "info",
            back : "main",
            content : "<p>Real estate equity is the difference between the current market value of the property and the amount the owner still owes on the mortgage. It is the amount that the owner would receive after selling a property and paying off the mortgage.</p><p><em>Equity At Purchase ($"+equityAtPurchase+") = Estimated Property Value ($"+estimatedPropertyValue+") - Purchase Price ($"+purchasePrice+") + Down Payment ($"+downPayment+")</em></p>"
          },
          loanAmount : {
            id : "loanAmount",
            title : "Loan Amount",
            type : "info",
            back : "main",
            content : "<p>The loan amount is the actual amount of money the lender is willing to allow you to borrow. Typically, lenders derive the loan amount based on their Loan to Value (LTV) ratio - which is the percentage of the property's value that is mortgaged. If you divide the mortgage amount by the lesser of either the appraised value or the selling price, you get the LTV.</p><p><em>However, for this calculation, the Loan Amount ($"+loanAmount+") = Purchase Price ($"+purchasePrice+") - Down Payment ($"+downPayment+")</em></p>"
          },
          closingCosts : {
            id : "closingCosts",
            title : "Closing Costs",
            type : "info",
            back : "main",
            content : "<p>Closing costs are the expenses, over and above the price of the property that buyers and sellers normally incur to complete a real estate transaction. Costs incurred include loan origination fees, discount points, appraisal fees, title searches, title insurance, surveys, taxes, deed-recording fees and credit report charges.</p><p><em>For the sake of simplicity, we're calculating the closing cost amount of $"+closingCosts+" based on "+closingCostsPercent+"% of the loan amount ($"+loanAmount+").</em></p>"
          },
          cashAtClosing : {
            id : "cashAtClosing",
            title : "Cash At Closing",
            type : "info",
            back : "main",
            content : "<p>Cash at Closing is the estimated amount of cash required to close or complete the sale of a real estate transaction.</p><p><em>Cash at Closing ($"+cashAtClosing+") = Down Payment ($"+downPayment+") + Closing Costs ($"+closingCosts+")</em></p>"
          },
          mortgagePayment : {
            id : "mortgagePayment",
            title : "Mortgage Payment",
            type : "info",
            back : "main",
            content : "<p>The mortgage payment is the estimated amount of monthly payments to your lender. This amount includes two parts: the amount that goes toward the principal of the loan (the money you've borrowed) and a second amount that goes toward interest (the cost of borrowing the money for the duration of your loan).</p><p><em>Thus, a Mortgage Payment of $"+mortgagePayment+" per month is based on a Loan Amount of $"+loanAmount+" at an Interest Rate of "+mortgageInterestRate+"% over a Loan Term of "+mortgageLoanTerm+" years.</em></p>"
          },
          mortgagePaymentYearly : {
            id : "mortgagePaymentYearly",
            title : "Mortgage Payment Yearly",
            type : "info",
            back : "main",
            content : "<p>Mortgage Payment Yearly is the estimated amount of mortgage payments for an entire year.</p><em>Thus, $"+mortgagePayment+" per month for 12 months would equal $"+mortgagePaymentYearly+" in total mortgage payments for that year.</em>"
          },
          rentalIncome : {
            id : "rentalIncome",
            title : "Rental Income",
            type : "input",
            mask : "currency",
            back : "main",
            value: rentalIncome,
            content : "<p>Rental Income is the estimated amount of total monthly rent for a given property. For duplex, triplex, etc. or properties with more than one tenant, enter a total amount of monthly rental income for all tenants.</p>"
          },
          propertyTaxes : {
            id : "propertyTaxes",
            title : "Property Taxes",
            type : "input",
            mask : "currency",
            back : "main",
            value : propertyTaxes,
            content : "<p>Property Taxes are taxes assessed on real estate by the local government. The tax is usually based on the value of the property (including the land) you own. Enter the estimated monthly amount of property taxes for this property.</p>"
          },
          homeownersInsurance : {
            id : "homeownersInsurance",
            title : "Homeowners Insurance",
            type : "input",
            mask : "currency",
            back : "main",
            value : homeownersInsurance,
            content : "<p>Homeowners Insurance is a form of property insurance designed to protect an individual's home against damages to the house itself, or to possessions in the home. Homeowners insurance also provides liability coverage against accidents in the home or on the property. Enter the estimated monthly amount of homeowners insurance for this property.</p>"
          },
          homeownersAssociation : {
            id : "homeownersAssociation",
            title : "Homeowners Association",
            type : "input",
            mask : "currency",
            back : "main",
            value : homeownersAssociation,
            content : "<p>The Homeowners Association (HOA) fee is an amount of money that must be paid monthly by owners of certain types of residential property to an organization that assists with maintaining and improving that property and others in the same group. HOA fees are almost always levied on condominium owners, but they may also apply in some single family neighborhoods. If applicable for this property, enter a monthly amount of HOA dues.</p>"
          },
          propertyManagement : {
            id : "propertyManagement",
            title : "Property Management",
            type : "info",
            back : "main",
            content : "<p>Property Management is the administration of residential, commercial and/or industrial real estate. Property management typically involves the managing of property that is owned by another party or entity. The property manager acts on behalf of the owner to preserve the value of the property while generating income. Property managers are typically paid a fee and/or a percentage of the rent brought in for the property while under management.</p><p><em>Property Management Fee ($"+propertyManagement+") = Monthly Rent ($"+rentalIncome+") x Property Management Percent ("+propertyManagementPercent+"%)</em></p>"
          },
          maintenanceReserve : {
            id : "maintenanceReserve",
            title : "Maintenance Reserve",
            type : "info",
            back : "main",
            content : "<p>A Maintenance Reserve is a monthly sum of money, usually a percentage of the rental income, set aside for maintenance expenses or costs incurred to keep the property in good condition.</p><p><em>Maintenance Reserve ($"+maintenanceReserve+") = Monthly Rent ($"+rentalIncome+") x Maintenance Reserve Percent ("+maintenanceReservePercent+"%)</em></p>"
          },
          vacancyAllowance : {
            id : "vacancyAllowance",
            title : "Vacancy Allowance",
            type : "info",
            back : "main",
            content : "<p>A Vacancy Allowance is a monthly sum of money, usually a percentage of the rental income, set aside for tenant vacancies or costs incurred between tenants when there is a loss of rental income.</p><p><em>Vacancy Allowance ($"+vacancyAllowance+") = Monthly Rent ($"+rentalIncome+") x Vacancy Allowance Percent ("+vacancyAllowancePercent+"%)</em></p>"
          },
          otherExpenses : {
            id : "otherExpenses",
            title : "Other Expenses",
            type : "input",
            back : "main",
            value: otherExpenses,
            content : "<p>Enter any additional miscellaneous monthly expense (such as gardening, pest control, utilities, closing cost loan interest, etc.)</p>"
          },
          otherExpensesDescription : {
            id : "otherExpensesDescription",
            title : "Other Expenses Description",
            type : "input",
            mask : "text",
            back : "main",
            value: otherExpensesDescription,
            content : "<p>Enter a brief description of additional miscellaneous monthly expenses (such as gardening, pest control, utilities, closing cost loan interest, etc.)</p>"
          },
          downPaymentPercent : {
            id : "downPaymentPercent",
            title : "Down Payment Percent",
            type : "input",
            mask : "percent",
            back : "settings",
            value : downPaymentPercent,
            content : "<p>Down Payment Percent is a percentage of the full purchase price, used to calculate the amount of Down Payment. Because houses are extremely expensive, home buyers typically pay down payments that equal 5-25% of the total value of the home. For investment properties, the down payment percent is typically 20% minimum.</p>"
          },
          mortgageInterestRate : {
            id : "mortgageInterestRate",
            title : "Mortgage Interest Rate",
            type : "input",
            mask : "percent",
            back : "settings",
            value : mortgageInterestRate,
            content : "<p>The Mortgage Interest Rate is the amount charged, expressed as a percentage of principal, by a lender to a borrower for the use of assets. Interest rates are typically noted on an annual basis, known as the annual percentage rate (APR). Interest is essentially a rental, or leasing charge to the borrower, for the asset's use.</p>"
          },
          mortgageLoanTerm : {
            id : "mortgageLoanTerm",
            title : "Mortgage Loan Term",
            type : "input",
            mask : "years",
            back : "settings",
            value : mortgageLoanTerm,
            content : "<p>The Mortgage Loan Term is the period of time assigned as the lifespan of the loan, expressed in number of years (e.g., 30 years, 15 years, etc.). The Term is the time it takes for all payments to be made by the borrower and received by the lender.</p>"
          },
          closingCostsPercent : {
            id : "closingCostsPercent",
            title : "Closing Costs Percent",
            type : "input",
            mask : "percent",
            back : "settings",
            value : closingCostsPercent,
            content : "<p>The Closing Cost Percent is a percentage amount of the loan amount, typically around 5% (could be higher or lower depending on the lender), which is used as a way to quickly estimate the total amount of closing costs, such as loan origination fees, discount points, appraisal fees, title searches, title insurance, surveys, taxes, deed-recording fees and credit report charges.</p>"
          },
          propertyManagementPercent : {
            id : "propertyManagementPercent",
            title : "Property Management Percent",
            type : "input",
            mask : "percent",
            back : "settings",
            value : propertyManagementPercent,
            content : "<p>A Property Management Percent is a percentage of the monthly rent, typically around 10% (could be higher or lower depending on the Property Management company), which is deducted out of the rental income amount on a monthly basis. Property Management companies are paid this fee in exchange for the administration of the property, tenant placement, etc. on behalf of the owner.</p>"
          },
          maintenanceReservePercent : {
            id : "maintenanceReservePercent",
            title : "Maintenance Reserve Percent",
            type : "input",
            mask : "percent",
            back : "settings",
            value : maintenanceReservePercent,
            content : "<p>The Maintenance Reserve Percent is a percentage of the monthly rent, used to calculate the amount of monthly maintenance reserves to set aside for maintenance costs, in order to keep the property in good condition for the tenant.</p>"
          },
          vacancyAllowancePercent : {
            id : "vacancyAllowancePercent",
            title : "Vacancy Allowance Percent",
            type : "input",
            mask : "percent",
            back : "settings",
            value : vacancyAllowancePercent,
            content : "<p>The Vacancy Allowance Percent is a percentage of the monthly rent, used to calculate the amount of monthly vacancy allowance to set aside for vacancy costs, in order to account for the loss in rental income during vacancies.</p>"
          },
          appreciationRate : {
            id : "appreciationRate",
            title : "Appreciation Rate",
            type : "input",
            mask : "percent",
            back : "settings",
            value : appreciationRate,
            content : "<p>The Appreciation Rate is the percent increase in the value of a property over time. The increase can occur for a number of reasons including increased demand or weakening supply, changes in inflation or interest rates, or other market conditions which may cause the value of the property to rise. This is the opposite of depreciation, which is a decrease over time.</p>"
          },
          monthlyCashFlow : {
            id : "monthlyCashFlow",
            title : "Monthly Cash Flow",
            type : "info",
            back : "main",
            content : "<p>Monthly Cash Flow is the net income produced by a property after all property expenses (taxes, insurance, HOA, property management, maintenance, vacancy, etc.) have been paid, including any mortgage payment, if applicable.</p><p><em>Monthly Cash Flow ($"+monthlyCashFlow+") = Rental Income ($"+rentalIncome+") - Operating Expenses ($"+operatingExpenses+") - Mortgage Payment ($"+mortgagePayment+")</em></p>"
          },
          capRate : {
            id : "capRate",
            title : "Cap Rate",
            type : "info",
            back : "main",
            content : "<p>Capitalization Rate is the rate of return on a real estate investment property based on the expected income that the property will generate. Cap rate is used to estimate the investor's potential return on his or her investment. This is done by dividing the income the property will generate (after fixed costs and variable costs) by the original price paid to buy the asset (or alternatively its current market value).</p><p><em>Cap Rate ("+capRate.toFixed(2)+"%) = Yearly Income ($"+(( rentalIncome - operatingExpenses ) * 12) +") / Purchase Price ($"+purchasePrice+")</em></p>"
          },
          cashOnCashReturn : {
            id : "cashOnCashReturn",
            title : "Cash On Cash Return (Yr 1)",
            type : "info",
            back : "main",
            content : "<p>The Cash On Cash Return is the ratio of annual before-tax cash flow (cash flow from rental income + appreciation + principle) to the total amount of cash invested, expressed as a percentage. It is generally considered a quick napkin test to determine if the asset qualifies for further review and analysis.</p><p><em>Cash On Cash Return (Yr 1) ("+cashOnCashReturn.toFixed(2)+"%) = Annual Before-tax Cash Flow ($"+(( monthlyCashFlow * 12 ) + appreciationYear1 + principleYear1 )+") / Cash At Closing ($"+cashAtClosing+")</em></p>"
          },
          equityInFiveYears : {
            id : "equityInFiveYears",
            title : "Equity In Five Years",
            type : "info",
            back : "main",
            content : "<p>Equity is the difference between the current market value of the property and the amount the owner still owes on the mortgage. It is the amount that the owner would receive after selling a property and paying off the mortgage.</p><p><em>In five years, with an appreciation rate of "+appreciationRate.toFixed(2)+"%, the equity on this property would be approximately $"+equityInFiveYears+".</em></p>"
          },
        }
      }

    });
  </script>
</head>

<body>

<!---------------------------------------
LIST
---------------------------------------->
<div data-role="page" id="list" class="page">

	<div id="listheader" data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">
    <a id="camera" href="#" class="ui-btn ui-btn-left ui-corner-all ui-icon-camera ui-btn-icon-left ui-btn-icon-notext" >Camera</a>
		<h1>Property Calculator</h1>
    <a id="new" href="#" class="ui-btn ui-btn-right ui-corner-all ui-icon-plus ui-btn-icon-right ui-btn-icon-notext" data-transition="slidefade">New</a>
	</div><!-- /header -->

	<div role="main">
    
    <ul id="properties" data-role="listview" data-inset="false" class="ui-nodisc-icon ui-alt-icon touch" data-icon="false" data-split-icon="delete">
    </ul>
    
	</div><!-- /content -->

</div><!-- /settings -->


<!---------------------------------------
MAIN
---------------------------------------->
<div data-role="page" id="main" class="page">

	<div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">
    <a href="#list" class="ui-btn ui-btn-left ui-corner-all ui-icon-bars ui-btn-icon-left ui-btn-icon-notext" data-transition="slidefade" data-direction="reverse">List</a>
		<h1><!-- propertyName --></h1>
    <a href="#settings" class="ui-btn ui-btn-right ui-corner-all ui-icon-gear ui-btn-icon-right ui-btn-icon-notext" data-transition="slideup">Settings</a>
    <a id="mail" href="#" class="ui-btn ui-btn-right ui-corner-all ui-icon-mail ui-btn-icon-right ui-btn-icon-notext" data-transition="slideup" style="right:40px;">Share</a>
	</div><!-- /header -->

	<div role="main">

    <ul data-role="listview" data-inset="false">
      <li data-role="list-divider" data-theme="b">Basic Purchase Information</li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#estimatedPropertyValue" data-transition="slidefade">Est. Property Value<span class="value money"></span></a></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#purchasePrice" data-transition="slidefade">Purchase Price<span class="value money"></span></a></li>
      <li data-icon="info"><a href="#equityAtPurchase" data-rel="dialog">Equity at Purchase<span class="value money"></span></a></li>
    </ul>

    <ul data-role="listview" data-inset="false">
      <li data-role="list-divider" data-theme="b">Mortgage Calculations</li>
      <li data-icon="info"><a href="#loanAmount" data-rel="dialog">Loan Amount<span class="value money"></span></a></li>
      <li data-icon="info"><a href="#downPayment" data-rel="dialog">Down Payment<span class="sm-amount"></span></span><span class="value money"></span></a></li>
      <li data-icon="info"><a href="#closingCosts" data-rel="dialog">Closing Costs<span class="sm-amount"></span><span class="value money"></span></a></li>
      <li data-icon="info"><a href="#cashAtClosing" data-rel="dialog">Cash at Closing<span class="value money"></span></a></li>
      <li data-icon="info"><a href="#mortgagePayment" data-rel="dialog">Mortgage Payment<span class="value money"></span></a></li>
      <li data-icon="info"><a href="#mortgagePaymentYearly" data-rel="dialog">Mortgage Payment<span class="sm-amount">(Yearly)</span><span class="value money"></span></a></li>
    </ul>
    
    <ul data-role="listview" data-inset="false">
      <li data-role="list-divider" data-theme="b" data-transition="none">Property Calculations<span class="sm-amount">(Per Month)</span></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#rentalIncome" data-transition="slidefade">Rental Income<span class="value money"></span></a></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#propertyTaxes" data-transition="slidefade">Property Taxes<span class="value money"></span></a></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#homeownersInsurance" data-transition="slidefade">Homeowners Insurance<span class="value money"></span></a></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#homeownersAssociation" data-transition="slidefade">Homeowners Association<span class="value money"></span></a></li>
      <li data-icon="info"><a href="#propertyManagement" data-rel="dialog">Property Management<span class="sm-amount"></span><span class="value money"></span></a></li>
      <li data-icon="info"><a href="#maintenanceReserve" data-rel="dialog">Maintenance Reserve<span class="sm-amount"></span><span class="value money"></span></a></li>
      <li data-icon="info"><a href="#vacancyAllowance" data-rel="dialog">Vacancy Allowance<span class="sm-amount"></span><span class="value money"></span></a></li>
      <li data-icon="info"><a href="#mortgagePayment" data-rel="dialog">Mortgage Payment<span class="value money"></span></a></li>
      <li class="ui-alt-icon ui-nodisc-icon"><a href="#otherExpenses" data-transition="slidefade">Other Expenses<span class="sm-amount"></span><span class="value money"></span></a></li>
    </ul>

    <div data-role="footer" data-position="fixed" data-theme="b" data-tap-toggle="false">
      <ul data-role="listview">
        <li data-icon="info"><a href="#monthlyCashFlow" data-rel="dialog">Monthly Cash Flow<span class="value money"></span></a></li>        
        <li data-icon="info"><a href="#capRate" data-rel="dialog">Cap Rate<span class="value percent"></span></a></li>
        <li data-icon="info"><a href="#cashOnCashReturn" data-rel="dialog">Cash on Cash Return<span class="value percent"></span></a></li>
        <li data-icon="info"><a href="#equityInFiveYears" data-rel="dialog">Equity in Five Years<span class="value money"></span></a></li>
      </ul>
    </div>
    
	</div><!-- /content -->

</div><!-- /main -->


<!---------------------------------------
SETTINGS
---------------------------------------->
<div data-role="page" id="settings" class="page">

	<div data-role="header" data-theme="a" data-position="fixed" data-tap-toggle="false">
		<h1>Settings</h1>
    <a class="ui-btn ui-btn-right ui-icon-carat-d ui-btn-icon-notext ui-corner-all" href="#main" data-transition="slideup" data-direction="reverse">Back</a>
	</div><!-- /header -->

	<div role="main">
    
    <ul data-role="listview" data-inset="false" class="ui-nodisc-icon ui-alt-icon">
      <li data-role="list-divider" data-theme="b">Mortgage Assumptions</li>
      <li><a href="#downPaymentPercent" data-transition="slidefade">Down Payment Percent<span class="value percent"></span></a></li>
      <li><a href="#mortgageInterestRate" data-transition="slidefade">Mortgage Interest Rate<span class="value percent"></span></a></li>
      <li><a href="#mortgageLoanTerm" data-transition="slidefade">Mortgage Loan Term<span class="value term"></span></a></li>
      <li><a href="#closingCostsPercent" data-transition="slidefade">Closing Costs Percent<span class="value percent"></span></a></li>
      <li data-role="list-divider" data-theme="b">Property Assumptions</li>
      <li><a href="#propertyManagementPercent" data-transition="slidefade">Property Management<span class="value percent"></span></a></li>
      <li><a href="#maintenanceReservePercent" data-transition="slidefade">Maintenance Reserve<span class="value percent"></span></a></li>
      <li><a href="#vacancyAllowancePercent" data-transition="slidefade">Vacancy Allowance<span class="value percent"></span></a></li>
      <li><a href="#appreciationRate" data-transition="slidefade">Appreciation Rate<span class="value percent"></span></a></li>
      <li data-role="list-divider" data-theme="b">Other Settings</li>
      <li><a href="#propertyName" data-transition="slidefade">Property Name<span class="value" style="display: none;"></span></a></li>
      <li><a href="#otherExpensesDescription" data-transition="slidefade">Other Expenses Description<span class="value" style="display: none;"></span></a></li>
    </ul>
    
	</div><!-- /content -->

</div><!-- /settings -->



</body>
</html>
